from src.agents.ideaAgent.graph import IdeaGraph

test_data= [
    """### NVDA 주가 전망

### 최근 동향 요약

- NVDA의 최근 30일간 주가는 상승과 하락을 반복하며 +/- 10% 이상의 변동성을 보였습니다.
- 평균 종가는 124.53이며, 현재 주가는 121.67로 약간의 하락세가 보입니다.

### 단기(1주) 전망

- **예상 주가 범위**: 120 ~ 126
- 최근 주가는 피로감을 나타내고 있어 일정한 조정이 필요할 것으로 보입니다. 단기적으로는 120달러 부근이 지지선 역할을 할 것으로 예상되며, 만약 이 지점을 이탈할 경우 더 큰 하락세가 나타날 가능성도 있습니다. 반면 126달러는 단기 저항선으로 작용할 수 있습니다.

### 중기(1달) 전망

- **예상 주가 범위**: 122 ~ 130
- 1개월 내에는 반등할 가능성이 존재합니다. 주가가 122달러를 유지하면 상승세를 살릴 수 있으며, 130달러 근처에서 저항을 받을 것으로 보입니다. 따라서 중기적으로도 122달러가 좋은 지지선으로 작용할 것으로 예상됩니다.

### 장기(6개월) 전망

- **예상 주가 범위**: 135 ~ 150
- 6개월 내에는 AI 및 데이터 센터 수요의 증가로 인해 NVDA의 주가는 긍정적인 영향을 받을 가능성이 큽니다. 장기적으로 135달러는 지지선으로 기능할 것으로 예상되며, 150달러는 저항선으로 작용할 것입니다.

### 주요 지지선/저항선

- **지지선**: 120 (단기), 122 (중기), 135 (장기)
- **저항선**: 126 (단기), 130 (중기), 150 (장기)

### 투자자들에게 조언할 사항

1. **단기적 조정 감안**: 현재 하락세가 지속될 경우, 120달러까지 하락할 위험이 있으므로 이 시기에 매수하려는 계획이 있는 경우 기다리는 것이 좋습니다.
2. **분할 매수 전략**: 아래 지지선 근처에서 분할 매수하는 전략을 고려할 수 있습니다.
3. **리스크 관리**: 주식 시장의 불확실성을 반영하여 포트폴리오의 리스크를 관리하세요.
4. **경제 지표 확인**: 경제 지표나 기술적 분석과의 조화를 고려하여 매매 결정을 내리는 것이 중요합니다.

---

### TSMC 주가 전망

### 최근 동향 요약
- TSMC의 최근 30일간 주가는 꾸준한 상승세를 보이며 약 8% 상승했습니다.
- 평균 종가는 145.30이며, 현재 주가는 148.20으로 상승 추세를 유지하고 있습니다.

### 단기(1주) 전망
- **예상 주가 범위**: 145 ~ 151
- 단기적으로 145달러 부근이 지지선 역할을 할 것으로 예상되며, 상방은 151달러까지 열려 있습니다.

### 중기(1달) 전망
- **예상 주가 범위**: 148 ~ 158
- AI 칩 수요와 모바일 칩 생산 증가에 따라 1개월 내 158달러 돌파를 시도할 가능성이 있습니다.

### 장기(6개월) 전망
- **예상 주가 범위**: 150 ~ 170
- 고성능 컴퓨팅 수요와 3나노 공정 확대가 장기적으로 긍정적 영향을 줄 것으로 예상됩니다.

### 주요 지지선/저항선
- **지지선**: 145 (단기), 148 (중기), 150 (장기)
- **저항선**: 151 (단기), 158 (중기), 170 (장기)

### 투자자들에게 조언할 사항
- **기술주 변동성 주의**: 글로벌 금리 변동에 따른 기술주 전반의 민감성에 주의가 필요합니다.
- **분할 매수 고려**: 단기 지지선 부근에서 분할 매수 전략이 유효할 수 있습니다.
- **공급망 리스크 점검**: 주요 고객사 주문 변동이나 공급망 이슈에도 주목해야 합니다.
- **장기 성장성 기대**: 3나노 및 2나노 기술 리더십을 통한 장기 성장성 확보에 주목하세요.

---

### IBM 주가 전망

### 최근 동향 요약
- IBM의 최근 30일간 주가는 안정적인 흐름을 보이며 2~3% 소폭 상승했습니다.
- 평균 종가는 167.45이며, 현재 주가는 169.00으로 소폭 상승 중입니다.

### 단기(1주) 전망
- **예상 주가 범위**: 166 ~ 172
- 하방은 166달러 수준에서 지지를 받을 것으로 보이며, 상방은 172달러까지 기대할 수 있습니다.

### 중기(1달) 전망
- **예상 주가 범위**: 168 ~ 178
- 하이브리드 클라우드 사업 확장과 AI 솔루션 수요 증가가 중기 상승 요인으로 작용할 가능성이 있습니다.

### 장기(6개월) 전망
- **예상 주가 범위**: 170 ~ 185
- 안정적인 캐시 플로우와 배당 매력이 장기 투자자들에게 긍정적 신호를 줄 것으로 예상됩니다.

### 주요 지지선/저항선
- **지지선**: 166 (단기), 168 (중기), 170 (장기)
- **저항선**: 172 (단기), 178 (중기), 185 (장기)

### 투자자들에게 조언할 사항
- **배당주로서 매력 검토**: 배당 수익률이 높은 종목으로 안정적 투자 포지션 가능성 검토.
- **클라우드/AI 전략 주목**: 신규 AI 솔루션과 클라우드 매출 비중 증가 여부를 주시하세요.
- **보수적 접근**: 기술적 조정이 있을 경우 지지선 부근 추가 매수 전략 검토.
- **전통 IT 기업 리스크**: 빠른 혁신이 필요한 시장 변화 속도에 대한 주의가 필요합니다.

---

### Palantir (PLTR) 주가 전망

### 최근 동향 요약
- PLTR의 최근 30일간 주가는 강한 랠리를 보이며 약 15% 상승했습니다.
- 평균 종가는 20.30이며, 현재 주가는 22.10로 꾸준히 상승세를 이어가고 있습니다.

### 단기(1주) 전망
- **예상 주가 범위**: 21 ~ 23
- 단기적으로 21달러가 지지선으로 작용할 것으로 예상되며, 상방은 23달러까지 열려 있습니다.

### 중기(1달) 전망
- **예상 주가 범위**: 20 ~ 25
- 정부 및 민간 부문 데이터 분석 수요 증가로 중기적으로 긍정적인 흐름이 지속될 가능성이 있습니다.

### 장기(6개월) 전망
- **예상 주가 범위**: 22 ~ 30
- AI와 빅데이터 수요 급증에 따라 장기적 성장 가능성이 주목받고 있습니다. 다만 밸류에이션 부담도 존재합니다.

### 주요 지지선/저항선
- **지지선**: 21 (단기), 20 (중기), 22 (장기)
- **저항선**: 23 (단기), 25 (중기), 30 (장기)

### 투자자들에게 조언할 사항
- **고성장주 변동성 주의**: 급등 이후 조정 가능성을 항상 염두에 둘 필요가 있습니다.
- **장기 투자 접근**: 고성장 스토리에 기반한 장기 투자 전략이 유효할 수 있습니다.
- **밸류에이션 리스크 점검**: 실적 대비 과도한 기대가 반영된 경우, 리스크를 분산할 필요가 있습니다.
- **정부 계약 주시**: 신규 정부 계약 수주 여부가 실적에 미치는 영향을 지속 모니터링하세요.

이 데이터를 기반으로 시장의 변화에 주의하고, 적절한 대응 전략을 갖추기를 권장합니다.
"""
]

class IdeaAgent:
    def __init__(self):
        self.graph = IdeaGraph()

    async def invoke(self, input: dict[str, any]):
        return await self.graph.invoke(input)

    def build(self):
        """그래프를 빌드하는 메서드"""
        pass

    def get_edges(self):
        """그래프의 엣지들을 반환하는 메서드"""
        return []

    def get_nodes(self):
        """그래프의 노드들을 반환하는 메서드"""
        return []

    @staticmethod
    async def test():
        agent = IdeaAgent()
        test_input = {
            "messages": [("user",f"{test_data[0]} 위는 분석 결과입니다. 이 결과를 바탕으로 트레이딩 가설을 생성해주세요. 반드시 형식을 지켜주세요.")]
        }
        result = await agent.invoke(test_input)
        print("테스트 결과:", result)
        return result    
